<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù…Ù†Ø¸Ù… ÙˆÙ‚Øª Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø©</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Tajawal', sans-serif; background: #f8fbff; color: #333; }
    .task-form-card { background: #fff; padding: 2rem; margin: 2rem auto; border-radius: 1.25rem; max-width: 850px; box-shadow: 0 8px 24px rgba(0,0,0,0.08); }
    .dark-mode { background-color: #121212 !important; color: #f0f0f0 !important; }
    .dark-mode .task-form-card { background-color: #1e1e1e !important; color: #fff !important; }
    .hero-banner {
    background: linear-gradient(to right, #6a11cb, #2575fc);
    color: white;
    padding: 2rem;
    text-align: center;
    border-radius: 1.5rem;
    margin: 2rem auto;
    max-width: 850px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
  }
  .hero-banner h2 {
    font-size: 2rem;
    margin-bottom: 0.5rem;
  }
  .hero-banner p {
    font-size: 1.1rem;
    margin-bottom: 0;
  }
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }
  .fade-in {
    animation: fadeIn 0.6s ease-in-out both;
  }
  .task-form-card {
    transition: box-shadow 0.3s ease;
  }
  .task-form-card:hover {
    box-shadow: 0 12px 32px rgba(0,0,0,0.12);
  }
</style>
</head>
<body>
  <header class="text-center py-4 bg-primary text-white">
  <div class="hero-banner">
    <div class="mb-3">
      <p><strong>ÙƒÙŠØ±Ù„Ø³ Ø­Ø²ÙŠÙ† Ù…Ø±Ø²ÙˆÙ‚ Ù‚Ø³Ø·Ù†Ø¬ÙŠ</strong></p>
      <p>free_edu2314131@edu.asu.edu.eg</p>
      <p><strong>Ù…Ø§Ø¯Ø©:</strong> ØªØµÙ…ÙŠÙ… Ù…ÙˆØ§Ù‚Ø¹</p>
      <p><strong>Ù…Ø´Ø±Ù Ø§Ù„Ù…Ø§Ø¯Ø©:</strong> Ø¯. Ù…Ø­Ù…Ø¯ Ø¹Ù†ØªØ±</p>
    </div>
    <h2>ğŸ“š Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù…Ù†Ø¸Ù… ÙˆÙ‚Øª Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø©</h2>
    <p>Ù‚Ù… Ø¨Ø¥Ø¯Ø§Ø±Ø© Ù…Ù‡Ø§Ù…Ùƒ Ø§Ù„ÙŠÙˆÙ…ÙŠØ© Ø¨Ø³Ù‡ÙˆÙ„Ø© ÙˆÙØ¹Ø§Ù„ÙŠØ© Ù…Ø¹ Ù…Ø¤Ù‚Øª Ø¨ÙˆÙ…ÙˆØ¯ÙˆØ±Ùˆ ÙˆÙˆØ§Ø¬Ù‡Ø© Ø¬Ø°Ø§Ø¨Ø©!</p>
  </div>
    <h1>Ù…Ù†Ø¸Ù… ÙˆÙ‚Øª Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø©</h1>
    <button class="btn btn-light btn-sm mt-3" onclick="toggleDarkMode()">ğŸŒ™ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ</button>
  </header>

<!-- Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø© -->
<div class="task-form-card fade-in">
  <h3 class="text-center">Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©</h3>
  <form onsubmit="addTask(event)">
    <div class="row g-3">
      <div class="col-md-6">
        <input type="text" class="form-control" id="task-title" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù‡Ù…Ø©" required>
      </div>
      <div class="col-md-6">
        <input type="time" class="form-control" id="task-time">
      </div>
      <div class="col-md-4">
        <select class="form-select" id="task-day">
          <option selected disabled>Ø§Ø®ØªØ± Ø§Ù„ÙŠÙˆÙ…</option>
          <option>Ø§Ù„Ø³Ø¨Øª</option>
          <option>Ø§Ù„Ø£Ø­Ø¯</option>
          <option>Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†</option>
          <option>Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡</option>
          <option>Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡</option>
          <option>Ø§Ù„Ø®Ù…ÙŠØ³</option>
          <option>Ø§Ù„Ø¬Ù…Ø¹Ø©</option>
        </select>
      </div>
      <div class="col-md-4">
        <select class="form-select" id="task-priority">
          <option selected disabled>Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©</option>
          <option>Ø¹Ø§Ù„ÙŠØ©</option>
          <option>Ù…ØªÙˆØ³Ø·Ø©</option>
          <option>Ù…Ù†Ø®ÙØ¶Ø©</option>
        </select>
      </div>
      <div class="col-md-4">
        <input type="text" class="form-control" id="task-note" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø£Ùˆ ØªØµÙ†ÙŠÙ">
      </div>
      <div class="col-12 text-center">
        <button type="submit" class="btn btn-primary px-5">Ø¥Ø¶Ø§ÙØ©</button>
      </div>
    </div>
    <div class="col-12 text-center">
      <input type="file" id="import-file" class="form-control" accept=".csv,.json" onchange="importTasks(event)">
    </div>
  </form>
</div>

  <!-- ÙÙ„ØªØ±Ø© Ø§Ù„ÙŠÙˆÙ… -->
  <div class="task-form-card">
    <h5>ÙÙ„ØªØ±Ø© Ø§Ù„Ù…Ù‡Ø§Ù… Ø­Ø³Ø¨ Ø§Ù„ÙŠÙˆÙ…:</h5>
    <select class="form-select" onchange="filterByDay(this.value)">
      <option value="">Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„</option>
      <option>Ø§Ù„Ø³Ø¨Øª</option>
      <option>Ø§Ù„Ø£Ø­Ø¯</option>
      <option>Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†</option>
      <option>Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡</option>
      <option>Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡</option>
      <option>Ø§Ù„Ø®Ù…ÙŠØ³</option>
      <option>Ø§Ù„Ø¬Ù…Ø¹Ø©</option>
    </select>
  </div>

  <!-- Ù‚Ø³Ù… Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ… -->
  <section class="task-form-card fade-in">
    <h3 class="text-center" id="today-heading"></h3>
    <div class="text-center mb-3">
      <button class="btn btn-outline-secondary btn-sm" onclick="renderTodayTasks(true)">Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ÙŠØ§Ù…</button>
    </div>
    <ul id="today-task-list" class="list-group"></ul>
  </section>

<!-- ØªÙ‚ÙˆÙŠÙ… Ø£Ø³Ø¨ÙˆØ¹ÙŠ Ø¨Ø³ÙŠØ· -->
<section class="task-form-card">
  <h3 class="text-center">Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ</h3>
  <div class="table-responsive">
    <table class="table table-bordered text-center align-middle">
      <thead class="table-light">
        <tr>
          <th>Ø§Ù„ÙŠÙˆÙ…</th>
          <th>Ø§Ù„Ù…Ù‡Ø§Ù…</th>
        </tr>
      </thead>
      <tbody id="weekly-calendar"></tbody>
    </table>
  </div>
</section>

<!-- Ù…Ø¤Ø´Ø± Ø§Ù„ØªÙ‚Ø¯Ù… -->
<section class="task-form-card">
  <h3 class="text-center">Ù†Ø³Ø¨Ø© Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ù…Ù‡Ø§Ù…</h3>
  <div class="progress" style="height: 30px;">
    <div class="progress-bar progress-bar-striped bg-success" id="progress-bar" style="width: 0%">0% Ù…ÙƒØªÙ…Ù„Ø©</div>
  </div>
</section>

<!-- Ù‚Ø§Ø¦Ù…Ø© ÙƒÙ„ Ø§Ù„Ù…Ù‡Ø§Ù… -->
<section class="task-form-card">
  <h3 class="text-center">ÙƒÙ„ Ø§Ù„Ù…Ù‡Ø§Ù…</h3>
  <ul id="task-list" class="list-group"></ul>
  <div class="text-center mt-3">
    <button class="btn btn-outline-danger" onclick="deleteAllTasks()">ğŸ—‘ï¸ Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù‡Ø§Ù…</button>
    <button class="btn btn-outline-primary" onclick="exportTasks()">ğŸ“ ØªØµØ¯ÙŠØ± CSV</button>
  </div>
</section>

<!-- Ù…Ø¤Ù‚Øª Ø¨ÙˆÙ…ÙˆØ¯ÙˆØ±Ùˆ -->
<section class="task-form-card text-center">
  <h3>Ù…Ø¤Ù‚Øª Ø¨ÙˆÙ…ÙˆØ¯ÙˆØ±Ùˆ</h3>
  <div id="pomodoro-timer" style="font-size: 2rem; margin-bottom: 1rem;">25:00</div>
  <button class="btn btn-success px-4" onclick="startPomodoro()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø¤Ù‚Øª</button>
  <button class="btn btn-warning px-4" onclick="pausePomodoro()">â¸ï¸ Ø¥ÙŠÙ‚Ø§Ù</button>
</section>

  <script>
    let tasks = JSON.parse(localStorage.getItem("tasks") || "[]");

// Ø­Ø³Ø§Ø¨ Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©
function calculateProgress() {
  const progress = document.getElementById("progress-bar");
  const doneCount = tasks.filter(t => t.done).length;
  const percent = tasks.length ? Math.round((doneCount / tasks.length) * 100) : 0;
  progress.style.width = percent + "%";
  progress.textContent = percent + "% Ù…ÙƒØªÙ…Ù„Ø©";
}

    function saveTasks() {
      localStorage.setItem("tasks", JSON.stringify(tasks));
    }

    function deleteTask(id) {
  tasks = tasks.filter(t => t.id !== id);
  saveTasks();
  renderTasks();
  renderTodayTasks();
  calculateProgress();
renderWeeklyCalendar();
}

function addTask(e) {
  e.preventDefault();
  const task = {
    id: Date.now(),
    title: document.getElementById("task-title").value,
    time: document.getElementById("task-time").value,
    day: document.getElementById("task-day").value,
    priority: document.getElementById("task-priority").value,
    note: document.getElementById("task-note").value,
    done: false
  };
  tasks.push(task);
  saveTasks();
  renderTasks();
  renderTodayTasks();
  calculateProgress();
  e.target.reset();
}
  function renderTodayTasks(showAll = false) {
  calculateProgress();
      const todayList = document.getElementById("today-task-list");
      const heading = document.getElementById("today-heading");

      let displayTasks;
      if (showAll) {
        heading.textContent = "ÙƒÙ„ Ø§Ù„Ù…Ù‡Ø§Ù…";
        displayTasks = tasks;
      } else {
        const today = new Date().toLocaleDateString('ar-EG', { weekday: 'long' });
        heading.textContent = `Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ… (${today})`;
        displayTasks = tasks.filter(t => t.day === today);
      }

      todayList.innerHTML = "";

      if (displayTasks.length === 0) {
        todayList.innerHTML = '<li class="list-group-item text-center text-muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù….</li>';
        return;
      }

      displayTasks.forEach(task => {
        const li = document.createElement("li");
        li.className = "list-group-item d-flex justify-content-between align-items-center";
        li.innerHTML = `
          <div>
            <strong>${task.title}</strong> ${task.time ? 'ğŸ•’ ' + task.time : ''}<br>
            <small class="text-muted">${task.priority} - ${task.note}</small>
          </div>
          <button class="btn btn-sm btn-danger" onclick="deleteTask(${task.id})">Ø­Ø°Ù</button>
        `;
        todayList.appendChild(li);
      });
    }

    function filterByDay(day) {
      renderTodayTasks(true);
      if (!day) return;
      const filtered = tasks.filter(t => t.day === day);
      const list = document.getElementById("today-task-list");
      const heading = document.getElementById("today-heading");
      heading.textContent = `Ø§Ù„Ù…Ù‡Ø§Ù… Ù„ÙŠÙˆÙ… ${day}`;
      list.innerHTML = "";

      if (filtered.length === 0) {
        list.innerHTML = '<li class="list-group-item text-center text-muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù… Ù„Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ….</li>';
        return;
      }

      filtered.forEach(task => {
        const li = document.createElement("li");
        li.className = "list-group-item d-flex justify-content-between align-items-center";
        li.innerHTML = `
          <div>
            <strong>${task.title}</strong> ${task.time ? 'ğŸ•’ ' + task.time : ''}<br>
            <small class="text-muted">${task.priority} - ${task.note}</small>
          </div>
          <button class="btn btn-sm btn-danger" onclick="deleteTask(${task.id})">Ø­Ø°Ù</button>
        `;
        list.appendChild(li);
      });
    }

    function toggleDarkMode() {
      document.body.classList.toggle("dark-mode");
    }

    renderTodayTasks();
  
function priorityValue(p) {
  if (p === "Ø¹Ø§Ù„ÙŠØ©") return 3;
  if (p === "Ù…ØªÙˆØ³Ø·Ø©") return 2;
  return 1;
}

function renderTasks() {
  const list = document.getElementById("task-list");
  list.innerHTML = "";
  if (tasks.length === 0) {
    list.innerHTML = '<li class="list-group-item text-center text-muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù….</li>';
    return;
  }
  tasks.sort((a, b) => priorityValue(b.priority) - priorityValue(a.priority));
tasks.forEach(task => {
    const li = document.createElement("li");
    li.className = "list-group-item d-flex justify-content-between align-items-center";
    li.innerHTML = `
      <div>
        <strong>${task.title}</strong> - ${task.day} ${task.done ? 'âœ…' : ''} ${task.time ? 'ğŸ•’ ' + task.time : ''}<br>
        <small class="text-muted">${task.priority} - ${task.note}</small>
      </div>
      <div>
        <button class="btn btn-sm btn-outline-success me-2" onclick="toggleDone(${task.id})">${task.done ? 'â†©ï¸ Ø¥Ù„ØºØ§Ø¡' : 'âœ… Ø¥Ù†Ø¬Ø§Ø²'}</button>
        <button class="btn btn-sm btn-secondary me-2" onclick="editTask(${task.id})">ØªØ¹Ø¯ÙŠÙ„</button>
        <button class="btn btn-sm btn-danger" onclick="deleteTask(${task.id})">Ø­Ø°Ù</button>
      </div>
    `;
    list.appendChild(li);
  });
}

function deleteAllTasks() {
  if (confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù‡Ø§Ù…ØŸ")) {
    tasks = [];
    saveTasks();
    renderTasks();
    renderTodayTasks();
    calculateProgress();
  }
}

function editTask(id) {
  const task = tasks.find(t => t.id === id);
  const newTitle = prompt("ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:", task.title);
  const newDay = prompt("ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ÙŠÙˆÙ…:", task.day);
  if (newTitle && newDay) {
    task.title = newTitle;
    task.day = newDay;
    saveTasks();
    renderTasks();
    renderTodayTasks();
    calculateProgress();
  }
}


let timer;
let duration = 25 * 60;
function startPomodoro() {
  clearInterval(timer);
  duration = 25 * 60;
  timer = setInterval(() => {
    if (duration <= 0) {
      clearInterval(timer);
      alert("Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª!");
      duration = 25 * 60;
    } else {
      duration--;
      const min = String(Math.floor(duration / 60)).padStart(2, '0');
      const sec = String(duration % 60).padStart(2, '0');
      document.getElementById("pomodoro-timer").textContent = `${min}:${sec}`;
    }
  }, 1000);
}

function pausePomodoro() {
  clearInterval(timer);
}

function exportTasks() {
  if (tasks.length === 0) return alert("Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù… Ù„Ù„ØªØµØ¯ÙŠØ±");
  let csv = "Ø§Ù„Ø¹Ù†ÙˆØ§Ù†,Ø§Ù„ÙŠÙˆÙ…,Ø§Ù„ÙˆÙ‚Øª,Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©,Ù…Ù„Ø§Ø­Ø¸Ø§Øª"

  tasks.forEach(t => {
    csv += `${t.title},${t.day},${t.time},${t.priority},${t.note}
`;
  });
  const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
  const url = URL.createObjectURL(blob);
  const link = document.createElement("a");
  link.setAttribute("href", url);
  link.setAttribute("download", "Ù…Ù‡Ø§Ù…ÙŠ.csv");
  link.click();
}
function toggleDone(id) {
  const task = tasks.find(t => t.id === id);
  task.done = !task.done;
  saveTasks();
  renderTasks();
  renderTodayTasks();
  calculateProgress();
}

// ØªÙ†Ø¨ÙŠÙ‡ Ø¹Ù†Ø¯ Ø§Ù‚ØªØ±Ø§Ø¨ Ù…ÙˆØ¹Ø¯ Ø§Ù„Ù…Ù‡Ù…Ø© Ø®Ù„Ø§Ù„ 10 Ø¯Ù‚Ø§Ø¦Ù‚
function checkUpcomingTasks() {
  const now = new Date();
  const currentDay = now.toLocaleDateString('ar-EG', { weekday: 'long' });
  const currentMinutes = now.getHours() * 60 + now.getMinutes();

  tasks.forEach(task => {
    if (task.day === currentDay && task.time && !task.notified) {
      const [h, m] = task.time.split(":").map(Number);
      const taskMinutes = h * 60 + m;
      if (taskMinutes - currentMinutes <= 10 && taskMinutes - currentMinutes > 0) {
        // Ø¥Ø´Ø¹Ø§Ø±
        if (Notification.permission === "granted") {
          new Notification("ğŸ“Œ ØªØ°ÙƒÙŠØ± Ø¨Ù…Ù‡Ù…Ø©:", {
            body: `${task.title} - ${task.time}`,
          });
        }
        task.notified = true;
        saveTasks();
      }
    }
  });
}

// Ø·Ù„Ø¨ Ø§Ù„Ø¥Ø°Ù† Ù„Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
if ("Notification" in window && Notification.permission !== "granted") {
  Notification.requestPermission();
}

// ØªØ­Ù‚Ù‚ ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø©
setInterval(checkUpcomingTasks, 60000);

function renderWeeklyCalendar() {
  const calendar = document.getElementById("weekly-calendar");
  const days = ["Ø§Ù„Ø³Ø¨Øª", "Ø§Ù„Ø£Ø­Ø¯", "Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†", "Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡", "Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡", "Ø§Ù„Ø®Ù…ÙŠØ³", "Ø§Ù„Ø¬Ù…Ø¹Ø©"];
  calendar.innerHTML = "";

  days.forEach(day => {
    const dayTasks = tasks.filter(t => t.day === day);
    const row = document.createElement("tr");

    const dayCell = document.createElement("td");
    dayCell.textContent = day;

    const taskCell = document.createElement("td");
    if (dayTasks.length === 0) {
      taskCell.innerHTML = '<span class="text-muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù…</span>';
    } else {
      const list = document.createElement("ul");
      list.className = "list-unstyled mb-0 text-start";
      dayTasks.forEach(task => {
        const item = document.createElement("li");
        item.textContent = `ğŸ”¹ ${task.title} ${task.time ? 'ğŸ•’ ' + task.time : ''}`;
        list.appendChild(item);
      });
      taskCell.appendChild(list);
    }

    row.appendChild(dayCell);
    row.appendChild(taskCell);
    calendar.appendChild(row);
  });
}

function importTasks(event) {
  const file = event.target.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = function(e) {
    try {
      let imported;
      if (file.name.endsWith('.json')) {
        imported = JSON.parse(e.target.result);
      } else {
        const lines = e.target.result.trim().split(
).slice(1); // Skip header
        imported = lines.map(line => {
          const [title, day, time, priority, note] = line.split(',');
          return { id: Date.now() + Math.random(), title, day, time, priority, note, done: false };
        });
      }
      tasks = tasks.concat(imported);
      saveTasks();
      renderTasks();
      renderTodayTasks();
      calculateProgress();
      renderWeeklyCalendar();
    } catch (err) {
      alert("Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù.");
    }
  };

  reader.readAsText(file);
}

// ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø© 19:00
const hourNow = new Date().getHours();
if (hourNow >= 19 || hourNow < 6) {
  document.body.classList.add("dark-mode");
}

// âœ… Ø¨Ø­Ø« Ù…Ø¨Ø§Ø´Ø±
function searchTasks(query) {
  const lower = query.toLowerCase();
  const filtered = tasks.filter(t =>
    t.title.toLowerCase().includes(lower) ||
    t.note.toLowerCase().includes(lower) ||
    t.day.toLowerCase().includes(lower)
  );

  const list = document.getElementById("task-list");
  list.innerHTML = "";

  if (filtered.length === 0) {
    list.innerHTML = '<li class="list-group-item text-center text-muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬.</li>';
    return;
  }

  filtered.forEach(task => {
    const li = document.createElement("li");
    li.className = "list-group-item d-flex justify-content-between align-items-center";
    li.innerHTML = `
      <div>
        <strong>${task.title}</strong> - ${task.day} ${task.done ? 'âœ…' : ''} ${task.time ? 'ğŸ•’ ' + task.time : ''}<br>
        <small class="text-muted">${task.priority} - ${task.note}</small>
      </div>
      <div>
        <button class="btn btn-sm btn-outline-success me-2" onclick="toggleDone(${task.id})">${task.done ? 'â†©ï¸ Ø¥Ù„ØºØ§Ø¡' : 'âœ… Ø¥Ù†Ø¬Ø§Ø²'}</button>
        <button class="btn btn-sm btn-secondary me-2" onclick="editTask(${task.id})">ØªØ¹Ø¯ÙŠÙ„</button>
        <button class="btn btn-sm btn-danger" onclick="deleteTask(${task.id})">Ø­Ø°Ù</button>
      </div>
    `;
    list.appendChild(li);
  });
}

// Ø­Ù‚Ù„ Ø¨Ø­Ø« Ù…Ø¨Ø§Ø´Ø± Ø£Ø¹Ù„Ù‰ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
const searchBar = document.createElement("input");
searchBar.className = "form-control mt-4 mb-3";
searchBar.placeholder = "ğŸ” Ø§Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ù‡Ø§Ù…...";
searchBar.oninput = e => searchTasks(e.target.value);
document.querySelector("#task-list").before(searchBar);
</script>
</body>
</html>
